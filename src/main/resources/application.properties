spring.application.name=personetakip

# ===================================================================
# Database Configuration - Local (Read/Write)
# ===================================================================
spring.datasource.url=jdbc:mysql://localhost:3306/personnel_tracking?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
spring.datasource.username=${DB_USERNAME:root}
spring.datasource.password=${DB_PASSWORD:sahinbey}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.properties.hibernate.connection.isolation=2
spring.jpa.open-in-view=false

# Database Connection Pool (HikariCP)
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ===================================================================
# Database Configuration - External (Read-Only)
# ===================================================================
external.datasource.url=jdbc:mysql://${EXTERNAL_DB_HOST:193.140.136.45}:3306/${EXTERNAL_DB_NAME:isicil}?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
external.datasource.username=${EXTERNAL_DB_USERNAME:isicil}
external.datasource.password=${EXTERNAL_DB_PASSWORD:TuruncuManTÄ°S2025!!}
external.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# External Database Connection Pool (HikariCP) - Read-Only
external.datasource.hikari.maximum-pool-size=5
external.datasource.hikari.minimum-idle=2
external.datasource.hikari.connection-timeout=30000
external.datasource.hikari.idle-timeout=600000
external.datasource.hikari.max-lifetime=1800000
external.datasource.hikari.read-only=true

# ===================================================================
# JWT Configuration
# ===================================================================
# JWT Secret - MUST be set via environment variable in production
# Default value is for development only (256-bit key)
jwt.secret=${JWT_SECRET:404E635266556A586E3272357538782F413F4428472B4B6250645367566B5970}
# JWT expiration time in milliseconds (30 minutes = 1800000ms)
jwt.expiration=${JWT_EXPIRATION:1800000}
# JWT issuer identifier
jwt.issuer=${JWT_ISSUER:personnel-tracking-system}

# ===================================================================
# SMS Gateway Configuration
# ===================================================================
sms.gateway.url=${SMS_GATEWAY_URL:http://localhost:8080/sms/send}
sms.gateway.api-key=${SMS_GATEWAY_API_KEY:test-api-key}
sms.gateway.sender=${SMS_SENDER_ID:PersonelTakip}

# ===================================================================
# OTP Configuration
# ===================================================================
otp.length=6
otp.expiration=300000

# ===================================================================
# QR Code Configuration
# ===================================================================
qrcode.size=300
qrcode.format=PNG

# ===================================================================
# Security Configuration
# ===================================================================
# SSL/HTTPS Configuration
# Disabled by default for development, MUST be enabled in production
server.ssl.enabled=${SSL_ENABLED:false}
server.ssl.key-store=${SSL_KEYSTORE_PATH:classpath:keystore.p12}
server.ssl.key-store-password=${SSL_KEYSTORE_PASSWORD:changeit}
server.ssl.key-store-type=${SSL_KEYSTORE_TYPE:PKCS12}
# SSL protocol to use
server.ssl.protocol=TLS
# Enabled SSL protocols
server.ssl.enabled-protocols=TLSv1.2,TLSv1.3
# SSL ciphers (strong ciphers only)
server.ssl.ciphers=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256

# CORS Configuration
# Allowed origins for CORS (comma-separated list)
# Use * for development, specific origins for production
cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:8100,capacitor://localhost,ionic://localhost}
# Allowed methods for CORS
cors.allowed-methods=${CORS_ALLOWED_METHODS:GET,POST,PUT,DELETE,OPTIONS,PATCH}
# Allowed headers for CORS
cors.allowed-headers=${CORS_ALLOWED_HEADERS:Authorization,Content-Type,Accept,X-Requested-With}
# Allow credentials (cookies, authorization headers)
cors.allow-credentials=${CORS_ALLOW_CREDENTIALS:true}
# Max age for preflight cache (in seconds)
cors.max-age=${CORS_MAX_AGE:3600}

# ===================================================================
# Logging Configuration
# ===================================================================
logging.level.root=INFO
logging.level.com.bidb.personetakip=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Logging pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ===================================================================
# Resilience4j Configuration
# ===================================================================
# Circuit Breaker for SMS Gateway
resilience4j.circuitbreaker.instances.smsGateway.registerHealthIndicator=true
resilience4j.circuitbreaker.instances.smsGateway.slidingWindowSize=10
resilience4j.circuitbreaker.instances.smsGateway.minimumNumberOfCalls=5
resilience4j.circuitbreaker.instances.smsGateway.failureRateThreshold=50
resilience4j.circuitbreaker.instances.smsGateway.waitDurationInOpenState=30000
resilience4j.circuitbreaker.instances.smsGateway.permittedNumberOfCallsInHalfOpenState=3

# Retry for SMS Gateway
resilience4j.retry.instances.smsGateway.maxAttempts=3
resilience4j.retry.instances.smsGateway.waitDuration=1000
resilience4j.retry.instances.smsGateway.enableExponentialBackoff=true
resilience4j.retry.instances.smsGateway.exponentialBackoffMultiplier=2

# Circuit Breaker for External Database
resilience4j.circuitbreaker.instances.externalDb.registerHealthIndicator=true
resilience4j.circuitbreaker.instances.externalDb.slidingWindowSize=10
resilience4j.circuitbreaker.instances.externalDb.minimumNumberOfCalls=5
resilience4j.circuitbreaker.instances.externalDb.failureRateThreshold=50
resilience4j.circuitbreaker.instances.externalDb.waitDurationInOpenState=30000

# Retry for External Database
resilience4j.retry.instances.externalDb.maxAttempts=3
resilience4j.retry.instances.externalDb.waitDuration=500
resilience4j.retry.instances.externalDb.enableExponentialBackoff=true

# ===================================================================
# Server Configuration
# ===================================================================
server.port=8080
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=on_param
server.error.include-exception=false

# ===================================================================
# Thymeleaf Configuration
# ===================================================================
spring.thymeleaf.cache=false
spring.thymeleaf.enabled=true
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.mode=HTML
spring.thymeleaf.encoding=UTF-8

# ===================================================================
# Actuator Configuration (for monitoring)
# ===================================================================
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized
