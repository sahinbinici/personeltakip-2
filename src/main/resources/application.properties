spring.application.name=personetakip

# ===================================================================
# Database Configuration - Local (Read/Write)
# ===================================================================
spring.datasource.url=jdbc:mysql://localhost:3306/personnel_tracking?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true&useUnicode=true&characterEncoding=UTF-8
spring.datasource.username=root
spring.datasource.password=sahinbey_
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.properties.hibernate.connection.isolation=2
spring.jpa.open-in-view=false

# Database Connection Pool (HikariCP)
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.connection-test-query=SELECT 1
spring.datasource.hikari.leak-detection-threshold=60000

# ===================================================================
# Database Configuration - External (Read-Only)
# ===================================================================
external.datasource.url=jdbc:mysql://${EXTERNAL_DB_HOST:193.140.136.145}:3306/${EXTERNAL_DB_NAME:isicil}?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
external.datasource.username=${EXTERNAL_DB_USERNAME:hesapi}
external.datasource.password=${EXTERNAL_DB_PASSWORD:TuruncuManTiS2025!!}
external.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# External Database Connection Pool (HikariCP) - Read-Only
external.datasource.hikari.maximum-pool-size=5
external.datasource.hikari.minimum-idle=2
external.datasource.hikari.connection-timeout=30000
external.datasource.hikari.idle-timeout=600000
external.datasource.hikari.max-lifetime=1800000
external.datasource.hikari.read-only=true
external.datasource.hikari.connection-test-query=SELECT 1
external.datasource.hikari.leak-detection-threshold=60000

# External JPA/Hibernate Configuration
external.jpa.hibernate.ddl-auto=none

# ===================================================================
# JWT Configuration
# ===================================================================
# JWT Secret - MUST be set via environment variable in production
# Default value is for development only (256-bit key)
jwt.secret=${JWT_SECRET:pLBfVYnOY+tyygibae7oVhbIN6GxHBbAsf6ak70dDdo=}
# JWT expiration time in milliseconds (30 minutes = 1800000ms)
jwt.expiration=${JWT_EXPIRATION:1800000}
# JWT issuer identifier
jwt.issuer=${JWT_ISSUER:personnel-tracking-system}

# ===================================================================
# SMS Gateway Configuration - VatanSMS
# ===================================================================
sms.gateway.url=${SMS_GATEWAY_URL:https://api.vatansms.net/api/v1/otp}
sms.gateway.api-id=${SMS_GATEWAY_API_ID:29d463733f56db81be9eb355}
sms.gateway.api-key=${SMS_GATEWAY_API_KEY:79259ea325e14e8603ab7cf7}
sms.gateway.sender=${SMS_SENDER_ID:G.ANTEP UNI}

# ===================================================================
# OTP Configuration
# ===================================================================
otp.length=6
otp.expiration=300000

# ===================================================================
# QR Code Configuration
# ===================================================================
qrcode.size=300
qrcode.format=PNG

# QR Code Usage Limits
# Set high values for development, lower for production
qr.code.max-usage-per-day=${QR_CODE_MAX_USAGE_PER_DAY:999}
qr.code.development-mode=${QR_CODE_DEVELOPMENT_MODE:true}

# ===================================================================
# Security Configuration
# ===================================================================
# SSL/HTTPS Configuration
# Disabled by default for development, MUST be enabled in production
server.ssl.enabled=${SSL_ENABLED:false}
server.ssl.key-store=${SSL_KEYSTORE_PATH:classpath:keystore.p12}
server.ssl.key-store-password=${SSL_KEYSTORE_PASSWORD:changeit}
server.ssl.key-store-type=${SSL_KEYSTORE_TYPE:PKCS12}
# SSL protocol to use
server.ssl.protocol=TLS
# Enabled SSL protocols
server.ssl.enabled-protocols=TLSv1.2,TLSv1.3
# SSL ciphers (strong ciphers only)
server.ssl.ciphers=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256

# CORS Configuration
# Allowed origins for CORS (comma-separated list)
# Use * for development, specific origins for production
cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:8100,capacitor://localhost,ionic://localhost,http://10.0.2.2:8081,http://localhost:8081}
# Allowed methods for CORS
cors.allowed-methods=${CORS_ALLOWED_METHODS:GET,POST,PUT,DELETE,OPTIONS,PATCH}
# Allowed headers for CORS
cors.allowed-headers=${CORS_ALLOWED_HEADERS:Authorization,Content-Type,Accept,X-Requested-With}
# Allow credentials (cookies, authorization headers)
cors.allow-credentials=${CORS_ALLOW_CREDENTIALS:true}
# Max age for preflight cache (in seconds)
cors.max-age=${CORS_MAX_AGE:3600}

# ===================================================================
# Logging Configuration
# ===================================================================
logging.level.root=INFO
logging.level.com.bidb.personetakip=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Logging pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ===================================================================
# Resilience4j Configuration
# ===================================================================
# Circuit Breaker for SMS Gateway
resilience4j.circuitbreaker.instances.smsGateway.registerHealthIndicator=true
resilience4j.circuitbreaker.instances.smsGateway.slidingWindowSize=10
resilience4j.circuitbreaker.instances.smsGateway.minimumNumberOfCalls=5
resilience4j.circuitbreaker.instances.smsGateway.failureRateThreshold=50
resilience4j.circuitbreaker.instances.smsGateway.waitDurationInOpenState=30000
resilience4j.circuitbreaker.instances.smsGateway.permittedNumberOfCallsInHalfOpenState=3

# Retry for SMS Gateway
resilience4j.retry.instances.smsGateway.maxAttempts=3
resilience4j.retry.instances.smsGateway.waitDuration=1000
resilience4j.retry.instances.smsGateway.enableExponentialBackoff=true
resilience4j.retry.instances.smsGateway.exponentialBackoffMultiplier=2

# Circuit Breaker for External Database
resilience4j.circuitbreaker.instances.externalDb.registerHealthIndicator=true
resilience4j.circuitbreaker.instances.externalDb.slidingWindowSize=10
resilience4j.circuitbreaker.instances.externalDb.minimumNumberOfCalls=5
resilience4j.circuitbreaker.instances.externalDb.failureRateThreshold=50
resilience4j.circuitbreaker.instances.externalDb.waitDurationInOpenState=30000

# Retry for External Database
resilience4j.retry.instances.externalDb.maxAttempts=3
resilience4j.retry.instances.externalDb.waitDuration=500
resilience4j.retry.instances.externalDb.enableExponentialBackoff=true

# ===================================================================
# Server Configuration
# ===================================================================
server.port=8080
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=on_param
server.error.include-exception=false

# ===================================================================
# Thymeleaf Configuration
# ===================================================================
spring.thymeleaf.cache=false
spring.thymeleaf.enabled=true
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.mode=HTML
spring.thymeleaf.encoding=UTF-8

# ===================================================================
# IP Tracking Configuration
# ===================================================================
# Enable/disable IP address tracking for entry/exit operations
ip.tracking.enabled=${IP_TRACKING_ENABLED:true}

# Privacy Settings
ip.tracking.privacy.enabled=${IP_TRACKING_PRIVACY_ENABLED:false}
ip.tracking.privacy.anonymize-reports=${IP_TRACKING_ANONYMIZE_REPORTS:false}
ip.tracking.privacy.audit-logging=${IP_TRACKING_AUDIT_LOGGING:true}
ip.tracking.privacy.retention-days=${IP_TRACKING_RETENTION_DAYS:365}
ip.tracking.privacy.require-consent=${IP_TRACKING_REQUIRE_CONSENT:false}

# Anonymization Settings
ip.tracking.anonymization.enabled=${IP_TRACKING_ANONYMIZATION_ENABLED:false}
ip.tracking.anonymization.method=${IP_TRACKING_ANONYMIZATION_METHOD:MASK}
ip.tracking.anonymization.ipv4-preserve-octets=${IP_TRACKING_IPV4_PRESERVE_OCTETS:2}
ip.tracking.anonymization.ipv6-preserve-groups=${IP_TRACKING_IPV6_PRESERVE_GROUPS:4}
ip.tracking.anonymization.mask-character=${IP_TRACKING_MASK_CHARACTER:x}

# Performance Settings
ip.tracking.performance.capture-timeout-ms=${IP_TRACKING_CAPTURE_TIMEOUT_MS:1000}
ip.tracking.performance.async-logging=${IP_TRACKING_ASYNC_LOGGING:true}
ip.tracking.performance.cache-size=${IP_TRACKING_CACHE_SIZE:1000}
ip.tracking.performance.cache-ttl-seconds=${IP_TRACKING_CACHE_TTL_SECONDS:300}
ip.tracking.performance.cache-validation=${IP_TRACKING_CACHE_VALIDATION:true}
ip.tracking.performance.batch-size=${IP_TRACKING_BATCH_SIZE:100}

# Security Settings
ip.tracking.security.input-validation=${IP_TRACKING_SECURITY_INPUT_VALIDATION:true}
ip.tracking.security.sanitization=${IP_TRACKING_SECURITY_SANITIZATION:true}
ip.tracking.security.encryption=${IP_TRACKING_SECURITY_ENCRYPTION:false}
ip.tracking.security.monitoring=${IP_TRACKING_SECURITY_MONITORING:true}
ip.tracking.security.suspicious-access-threshold=${IP_TRACKING_SUSPICIOUS_ACCESS_THRESHOLD:50}
ip.tracking.security.max-ip-length=${IP_TRACKING_MAX_IP_LENGTH:45}
ip.tracking.security.min-ip-length=${IP_TRACKING_MIN_IP_LENGTH:7}

# ===================================================================
# Actuator Configuration (for monitoring)
# ===================================================================
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized
